<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"><title>示波器仿真系统</title><script defer="defer" src="./js/vendors.bundle.js"></script><script defer="defer" src="./js/external.bundle.js"></script></head><body><div id="app"><header><h1>示波器仿真系统</h1><div class="exp-steps"><button @click="setExpStep('calibration')" :class="{ active: expStep === 'calibration' }">1. 自检校准</button> <button id="normal-mode-btn" @click="setExpStep('normal')" :class="{ active: expStep === 'normal' }">2. 标准测量</button></div></header><main><aside><div v-if="expStep === 'calibration'" class="calibration-panel"><h2>示波器自检校准</h2><section><h3>通道控制</h3><div class="channel-control"><div v-for="line in [1, 2]" :key="line" class="b1"><button @click="toggleInput(line)"><span class="channel-color-block" :style="{ backgroundColor: line === 1 ? '#2196F3' : '#FF5722' }"></span> 通道 {{ line }} <span class="indicator" :class="{ on: inputActive[line] }"></span></button></div></div></section><div class="calibration-info"><div class="info-row"><strong>当前通道配置 (固定参数)：</strong><div class="info-channel"><div>通道1: 方波 (1 Hz, 4Vpp)</div><div>通道2: 方波 (1 Hz, 4Vpp)</div></div></div></div></div><div class="control-panel"><div class="parameter-settings"><section class="parameter-section signal-source-section" v-if="expStep !== 'calibration'"><div class="section-header"><span class="section-label">信号源</span></div><div class="signal-source-controls"><div class="wave-select-container"><h4>波形选择</h4><div class="wave-select"><button v-for="wave in waveTypes" :key="wave.type" @click="setSignalType(wave.type)" :class="{ active: signalType === wave.type }">{{ wave.name }}</button></div></div><div class="channel-control-container"><h4>通道控制</h4><div class="channel-control"><div v-for="line in [1, 2]" :key="line" class="b1"><button @click="toggleInput(line)"><span class="channel-color-block" :style="{ backgroundColor: line === 1 ? '#2196F3' : '#FF5722' }"></span> 通道 {{ line }} <span class="indicator" :class="{ on: inputActive[line] }"></span></button></div></div></div></div><div class="parameter-control"><h4>参数设置</h4><table><thead><tr><th>参数名</th><th>通道1</th><th>通道2</th></tr></thead><tbody><tr class="knob"><td><label for="peak-ch1">峰峰值（Vpp）:</label></td><td><input type="number" id="peak-ch1" name="peak-ch1" :value="expStep === 'calibration' ? calibrationParams.peakValues[1] : peakValues[1]" @input="e => expStep !== 'calibration' && $set(peakValues, 1, Number(e.target.value))" min="0.1" max="10" step="0.1" :disabled="expStep === 'calibration'"></td><td><input type="number" id="peak-ch2" name="peak-ch2" :value="expStep === 'calibration' ? calibrationParams.peakValues[2] : peakValues[2]" @input="e => expStep !== 'calibration' && $set(peakValues, 2, Number(e.target.value))" min="0.1" max="10" step="0.1" :disabled="expStep === 'calibration'"></td></tr><tr class="knob"><td><label for="freq-ch1">频率（Hz）:</label></td><td><input type="number" id="freq-ch1" name="freq-ch1" :value="currentMode === 'lissajous' ? freqX : (expStep === 'calibration' ? calibrationParams.frequencies[1] : frequencies[1])" @input="e => {
                                if (currentMode === 'lissajous') {
                                  freqX = Number(e.target.value);
                                  needsRedraw = true;
                                  refreshDisplay();
                                } else if (expStep !== 'calibration') {
                                  $set(frequencies, 1, Number(e.target.value))
                                }
                              }" min="0.1" max="10" step="0.1" :disabled="expStep === 'calibration' && currentMode !== 'lissajous'"></td><td><input type="number" id="freq-ch2" name="freq-ch2" :value="currentMode === 'lissajous' ? freqY : (expStep === 'calibration' ? calibrationParams.frequencies[2] : frequencies[2])" @input="e => {
                                if (currentMode === 'lissajous') {
                                  freqY = Number(e.target.value);
                                  needsRedraw = true;
                                  refreshDisplay();
                                } else if (expStep !== 'calibration') {
                                  $set(frequencies, 2, Number(e.target.value))
                                }
                              }" min="0.1" max="10" step="0.1" :disabled="expStep === 'calibration' && currentMode !== 'lissajous'"></td></tr><tr class="knob"><td><label for="phase-diff-new">初相差(°):</label></td><td colspan="2"><div class="phase-control"><button @click="adjustParam('phaseDiff', -10)" aria-label="减小初相差" class="arrow-button">&#8592;</button> <input type="number" id="phase-diff-new" v-model.number="phaseDiff" min="0" max="360" step="5" @input="needsRedraw = true; refreshDisplay();"> <button @click="adjustParam('phaseDiff', 10)" aria-label="增加初相差" class="arrow-button">&#8594;</button></div></td></tr></tbody></table></div></section><div class="display-mode-switcher" v-if="expStep !== 'calibration'"><h3>显示模式</h3><div class="display-mode-buttons"><button @click="setDisplayMode('independent')" :class="{ active: displayMode === 'independent' }">独立显示</button> <button @click="setDisplayMode('overlay')" :class="{ active: displayMode === 'overlay' }">同向叠加</button> <button id="lissajous-mode-btn" @click="setDisplayMode('vertical')" :class="{ active: displayMode === 'vertical' }">垂直叠加</button></div></div><section class="time-voltage-section"><h2>{{ displayMode === 'vertical' ? '电压' : '时间与电压' }}</h2><table><tr v-if="displayMode !== 'vertical'"><td style="padding-left: 40px;"><label v-if="currentMode !== 'lissajous'" for="time-div">时间（s/div）</label> <label v-else for="time-div">X轴频率</label></td><td class="control-group"><div class="reading-controls"><button @click="currentMode==='lissajous'?adjustParam('freqX',-0.1):adjustParam('timeDiv',-1)">-</button> <input type="number" id="time-div" name="time-div" :value="currentMode==='lissajous'?freqX:timeDiv" @input="e=>{
                   if(currentMode==='lissajous'){freqX=Number(e.target.value);needsRedraw=true;refreshDisplay();}
                   else{timeDiv=Number(e.target.value);}
                 }" @keydown.left="currentMode==='lissajous'?adjustParam('freqX',-0.1):adjustParam('timeDiv',-1)" @keydown.right="currentMode==='lissajous'?adjustParam('freqX',0.1):adjustParam('timeDiv',1)" @change="currentMode!=='lissajous'&&validateInput('time')" min="0.1" max="100" step="0.1"> <button @click="currentMode==='lissajous'?adjustParam('freqX',0.1):adjustParam('timeDiv',1)">+</button></div></td></tr><tr v-if="displayMode !== 'vertical' && expStep === 'calibration'" class="slider-row"><td colspan="2"><div class="slider-container"><div class="slider-tooltip">波形显示微调</div><div class="slider" @mousedown="startSlider('time',null)" :class="{active:sliderActive&&sliderActive.type==='time'}" :style="{ '--slider-value':calculateSliderPosition('time') }" role="slider" aria-valuemin="0.1" aria-valuemax="2.0" :aria-valuenow="displayAdjustFactors.time"></div></div></td></tr><tr><td style="padding-left:40px; white-space:nowrap;"><label for="volts-div-1">电压CH1（V/div）</label></td><td class="control-group"><div class="reading-controls"><button @click="adjustParam('voltsDiv',-0.1,1)">-</button> <input type="number" id="volts-div-1" name="volts-div-1" :value="voltsDiv[1]" @input="e=>{
                   voltsDiv[1]=Number(e.target.value);
                   if(displayMode==='vertical'){needsRedraw=true;validateInput('volts',1);}
                 }" @keydown.left="adjustParam('voltsDiv',-0.1,1)" @keydown.right="adjustParam('voltsDiv',0.1,1)" @change="validateInput('volts',1)" min="0.1" max="10" step="0.01"> <button @click="adjustParam('voltsDiv',0.1,1)">+</button></div></td></tr><tr v-if="expStep === 'calibration'" class="slider-row"><td colspan="2"><div class="slider-container"><div class="slider-tooltip">波形显示微调</div><div class="slider" @mousedown="startSlider('volts',1)" :class="{active:sliderActive&&sliderActive.type==='volts'&&sliderActive.line===1}" :style="{ '--slider-value':calculateSliderPosition('volts',1) }" role="slider" :aria-valuenow="displayAdjustFactors.volts[1]" aria-valuemin="0.1" aria-valuemax="2.0"></div></div></td></tr><tr><td style="padding-left:40px; white-space:nowrap;"><label for="volts-div-2">电压CH2（V/div）</label></td><td class="control-group"><div class="reading-controls"><button @click="adjustParam('voltsDiv',-0.1,2)">-</button> <input type="number" id="volts-div-2" name="volts-div-2" :value="voltsDiv[2]" @input="e=>{
                   voltsDiv[2]=Number(e.target.value);
                   if(displayMode==='vertical'){needsRedraw=true;validateInput('volts',2);}
                 }" @keydown.left="adjustParam('voltsDiv',-0.1,2)" @keydown.right="adjustParam('voltsDiv',0.1,2)" @change="validateInput('volts',2)" min="0.1" max="10" step="0.01"> <button @click="adjustParam('voltsDiv',0.1,2)">+</button></div></td></tr><tr v-if="expStep === 'calibration'" class="slider-row"><td colspan="2"><div class="slider-container"><div class="slider-tooltip">波形显示微调</div><div class="slider" @mousedown="startSlider('volts',2)" :class="{active:sliderActive&&sliderActive.type==='volts'&&sliderActive.line===2}" :style="{ '--slider-value':calculateSliderPosition('volts',2) }" role="slider" :aria-valuenow="displayAdjustFactors.volts[2]" aria-valuemin="0.1" aria-valuemax="2.0"></div></div></td></tr><tr><td style="padding-left:40px; white-space:nowrap;"><label for="horizontal-pos">水平位置</label></td><td class="control-group" style="justify-content:center;"><div class="position-controls"><button @click="adjustPosition('horizontal',-0.1)" class="arrow-button">&#8592;</button> <input type="number" id="horizontal-pos" v-model.number="horizontalPosition" min="-8" max="8" step="0.1" style="display:none;"> <button @click="adjustPosition('horizontal',0.1)" class="arrow-button">&#8594;</button></div></td></tr><tr><td style="padding-left:40px; white-space:nowrap;"><label>垂直位置</label></td><td class="control-group" style="justify-content:space-around;"><div class="position-controls"><span>CH1</span> <button @click="adjustPosition('vertical',-0.1,1)" class="arrow-button">&#8593;</button> <input type="number" id="vertical-pos-1" v-model.number="verticalPosition[1]" min="-4" max="4" step="0.1" style="display:none;"> <button @click="adjustPosition('vertical',0.1,1)" class="arrow-button">&#8595;</button></div><div class="position-controls"><span>CH2</span> <button @click="adjustPosition('vertical',-0.1,2)" class="arrow-button">&#8593;</button> <input type="number" id="vertical-pos-2" v-model.number="verticalPosition[2]" min="-4" max="4" step="0.1" style="display:none;"> <button @click="adjustPosition('vertical',0.1,2)" class="arrow-button">&#8595;</button></div></td></tr></table></section><section class="trigger-section"><h3>触发系统控制</h3><div class="trigger-description">触发系统用于稳定波形显示，设置触发电平可捕获特定幅值的信号。</div><div class="trigger-controls"><div class="trigger-row"><div class="trigger-mode-control"><button @click="toggleRunning" :class="{ active: !isRunning }">{{ isRunning ? '暂停' : '运行' }}</button> <button @click="resetTrigger" title="重置触发设置">重置电平</button></div><div class="trigger-level"><label for="trigger-level">触发电平:</label><div class="level-knob"><button @click="adjustLevel(-0.1)" aria-label="减小触发电平">-</button> <input type="number" id="trigger-level" name="trigger-level" v-model.number="triggerLevel" min="-5" max="5" step="0.1" aria-label="触发电平值"> <button @click="adjustLevel(0.1)" aria-label="增加触发电平">+</button></div></div></div><div class="level-slider"><div class="level-track"><div class="level-indicator" :style="{ top: triggerLevelPosition + 'px' }"></div></div><div class="level-value">{{ triggerLevel.toFixed(1) }}V</div></div></div></section></div></div></aside><section class="oscilloscope"><canvas ref="oscilloscope" width="800" height="400"></canvas></section></main></div></body></html>